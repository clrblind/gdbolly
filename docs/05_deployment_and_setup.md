# Развертывание и Настройка

## 1. Требования
*   Docker Engine
*   Docker Compose

## 2. Структура контейнеров
Проект состоит из двух сервисов, описанных в `docker-compose.yml`:

### 2.1. `backend`
*   **Base Image**: `python:3.11-slim`
*   **Зависимости**: `gdb`, `gcc`. Устанавливаются через `apt-get` в Dockerfile.
*   **Привилегии**:
    *   `cap_add: [SYS_PTRACE]`: Разрешает отладчику подключаться к процессам. Без этого GDB работать не будет.
    *   `security_opt: [seccomp:unconfined]`: Отключает ограничения системных вызовов, которые могут мешать GDB.
*   **Volumes**:
    *   `./targets`: Директория для исполняемых файлов. Прокидывается внутрь контейнера.
    *   `./database`: Директория для хранения SQLite файлов (`.db`).
*   **Порт**: 8000.

### 2.2. `frontend`
*   **Base Image**: `node:20-alpine`
*   **Режим**: Development (`vite dev`).
*   **Порт**: 3333 (мапится на внутренний 3000).
*   **Hot Reload**: Включен polling (`CHOKIDAR_USEPOLLING=true`), чтобы изменения файлов на Windows хостах корректно подхватывались внутри Linux контейнера.

## 3. Запуск
Используйте скрипт `run.sh.txt` (или переименуйте его в `run.sh`).

```bash
# Дать права на выполнение
chmod +x run.sh.txt

# Запуск
./run.sh.txt
```

Скрипт выполняет `docker compose up --build` и обеспечивает корректную очистку ресурсов (удаление volumes) при нажатии Ctrl+C.

## 4. Добавление новых бинарников
1.  Положите исходный код (например, `test.c`) или скомпилированный бинарник в папку `targets/` в корне проекта.
2.  Если это `.c` файл, бэкенд попытается автоматически скомпилировать его при загрузке сессии (см. логику в `backend/main.py.txt`, метод `load_binary`).
3.  Для ручной компиляции внутри контейнера:
    ```bash
    docker compose exec backend bash
    gcc -g /targets/myprog.c -o /targets/myprog
    ```
    Флаг `-g` обязателен для получения отладочной информации (символов), хотя GDB может работать и без них (strip binary), но UX будет хуже.

## 5. Известные проблемы
*   **Race Condition при рестарте**: В коде реализован механизм отмены задач (`io_task.cancel()`), но при очень частом нажатии Reload возможны пограничные состояния.
*   **Node Deprecation Warnings**: При сборке фронтенда могут появляться варнинги `punycode`. Исправлено обновлением до Node 20 и свежего Vite, но некоторые зависимости могут все еще вызывать их.
