# Документация Фронтенда (React/Redux)

## 1. Общая структура
Приложение создано с помощью Vite.
*   `src/store/`: Конфигурация Redux (Slices, Middleware).
*   `src/components/`: React компоненты.
*   `src/hooks/`: (В данный момент не используется активно, логика в компонентах).

## 2. Управление состоянием (Redux Slice: `debuggerSlice`)
Файл `store/debuggerSlice.js` является единым источником правды.

### Ключевые поля состояния:
*   `status`: Текущее состояние отладчика (IDLE, RUNNING, PAUSED). Влияет на доступность кнопок управления.
*   `disassembly`: Массив объектов инструкций (адрес, мнемоника, опкоды).
*   `viewStartAddress`: Адрес первой строки, отображаемой в данный момент в окне дизассемблера. Это поле отвязано от регистра RIP. RIP может быть где угодно, а пользователь может скроллить листинг.
*   `historyPast` / `historyFuture`: Стеки для навигации (кнопки Назад/Вперед или Num-/Num+). Реализуют браузеро-подобную навигацию по коду.
*   `modifiedAddresses`: Массив адресов, которые были запатчены. Используется для отрисовки "Красного текста на черном фоне".
*   `settings`: Объект настроек (формат чисел, регистра, кейсинг).

## 3. Компонент `DisassemblyPane.jsx`
Самый сложный компонент системы. Отвечает за рендеринг ассемблерного листинга.

### 3.1. Логика рендеринга
*   **Парсинг**: GDB возвращает сырую строку (например, `mov $0x0, %eax`). Компонент `DisassemblyPane` парсит эту строку на лету:
    *   Разделяет мнемонику и операнды.
    *   Применяет настройки форматирования (Upper/Lower case).
    *   Подсвечивает регистры (жирным).
    *   Меняет местами аргументы (Swap Arguments), если включена настройка (AT&T vs Intel syntax emulation).
*   **Виртуализация**: В текущей версии используется простой `map` по массиву. **План на будущее**: внедрить `react-window` для поддержки огромных листингов без просадки FPS.
*   **Стилизация**: Используется `styled-components`.
    *   Инструкции `RET` (ret, retn) подсвечиваются красным.
    *   Активная инструкция (RIP) имеет серый фон.
    *   Выделенные строки — синий фон.
    *   Измененные (запатченные) строки — черный фон, красный текст.

### 3.2. Взаимодействие
*   **Клик**: Выделение строки.
*   **Ctrl+Click**: Множественное выделение.
*   **Shift+Click**: Выделение диапазона.
*   **Double Click**: Если в строке есть адрес (например, `call 0x401000`), происходит переход по этому адресу (push в историю).

## 4. Система патчинга (Patching System)
Реализована в `App.jsx` и `debuggerSlice.js`.

1.  Пользователь выбирает строки и нажимает "Edit" или "Binary -> Fill".
2.  Открывается модальное окно (`XPModal`).
3.  При подтверждении вызывается `performPatch`.
4.  Формируется массив байт.
5.  Отправляется запрос на бэкенд `/memory/write`.
6.  При успехе адреса добавляются в `modifiedAddresses` (Redux).
7.  Вызывается `refreshDisassembly`, чтобы GDB пере-дизассемблировал код (например, `90` превратилось в `nop`).
8.  **Revert**: При нажатии Alt+Backspace, происходит обратный процесс через `/memory/revert`.

## 5. UI Компоненты
*   **`Layout.jsx`**: Отвечает за ресайз панелей. Использует процентное соотношение ширины/высоты. Реализует жесткий `overflow: hidden`, чтобы приложение занимало ровно 100% окна браузера без скроллбаров.
*   **`XPModal.jsx`**: Кастомная реализация модальных окон в стиле Windows XP/2000. Поддерживает перетаскивание (Draggable) за заголовок. Перехватывает `Enter` и `Escape` для улучшения UX.
*   **`ContextMenu.jsx`**: Кастомное контекстное меню. Поддерживает вложенные подменю (Submenus) и горячие клавиши в описании.
